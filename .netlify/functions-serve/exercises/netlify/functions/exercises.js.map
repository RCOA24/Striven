{
  "version": 3,
  "sources": ["file:///S:/VSCodeProjects/Striven/netlify/functions/exercises.js"],
  "sourceRoot": "C:/Users/rodne/AppData/Local/Temp/tmp-15652-7kzKeyl46Gf6",
  "sourcesContent": ["// netlify/functions/exercises.js\r\n// Serverless function to proxy RapidAPI ExerciseDB requests\r\n\r\nconst RAPIDAPI_HOST = 'exercisedb.p.rapidapi.com';\r\nconst RAPIDAPI_KEY = process.env.VITE_RAPIDAPI_KEY || 'a1ef16478dmshfa2196906761101p1da34ejsn088c64356d48';\r\n\r\nexport const handler = async (event) => {\r\n  // Handle CORS preflight\r\n  if (event.httpMethod === 'OPTIONS') {\r\n    return {\r\n      statusCode: 200,\r\n      headers: {\r\n        'Access-Control-Allow-Origin': '*',\r\n        'Access-Control-Allow-Methods': 'GET, OPTIONS',\r\n        'Access-Control-Allow-Headers': 'Content-Type',\r\n      },\r\n      body: ''\r\n    };\r\n  }\r\n\r\n  try {\r\n    // Parse path\r\n    // event.path comes in as /.netlify/functions/exercises (rewritten)\r\n    // or /api/exercises (if raw) - usually rewritten.\r\n    \r\n    let path = event.path;\r\n    \r\n    // We need to map this to the RapidAPI path.\r\n    // If path ends with /exercises, we want /exercises\r\n    // If path ends with /exercises/bodyPartList, we want /exercises/bodyPartList\r\n    \r\n    // Remove the function prefix\r\n    const functionPrefix = '/.netlify/functions/exercises';\r\n    const apiPrefix = '/api/exercises';\r\n    \r\n    let apiPath = '';\r\n    \r\n    if (path.startsWith(functionPrefix)) {\r\n      apiPath = path.substring(functionPrefix.length);\r\n    } else if (path.startsWith(apiPrefix)) {\r\n      apiPath = path.substring(apiPrefix.length);\r\n    }\r\n    \r\n    // If apiPath is empty, it means we are at the root of the resource\r\n    // In dev, /api/exercises mapped to /exercises\r\n    // So we should prepend /exercises\r\n    \r\n    const targetPath = '/exercises' + apiPath;\r\n    \r\n    // Construct query string\r\n    const params = new URLSearchParams(event.queryStringParameters);\r\n    const queryString = params.toString() ? `?${params.toString()}` : '';\r\n    \r\n    const targetUrl = `https://${RAPIDAPI_HOST}${targetPath}${queryString}`;\r\n    \r\n    console.log(`Proxying ${path} to ${targetUrl}`);\r\n\r\n    const response = await fetch(targetUrl, {\r\n      method: event.httpMethod,\r\n      headers: {\r\n        'x-rapidapi-host': RAPIDAPI_HOST,\r\n        'x-rapidapi-key': RAPIDAPI_KEY,\r\n        'Content-Type': 'application/json',\r\n      },\r\n    });\r\n    \r\n    const data = await response.text();\r\n    // Try to parse as JSON, otherwise return error\r\n    let isJson = false;\r\n    let jsonData = null;\r\n    try {\r\n      jsonData = JSON.parse(data);\r\n      isJson = true;\r\n    } catch (e) {\r\n      isJson = false;\r\n    }\r\n    if (!isJson) {\r\n      return {\r\n        statusCode: 502,\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Access-Control-Allow-Origin': '*',\r\n          'Cache-Control': 'no-cache',\r\n        },\r\n        body: JSON.stringify({ error: 'Invalid response from upstream API', details: data.slice(0, 200) })\r\n      };\r\n    }\r\n    return {\r\n      statusCode: response.status,\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'Access-Control-Allow-Origin': '*',\r\n        'Cache-Control': response.ok ? 'public, max-age=3600' : 'no-cache',\r\n      },\r\n      body: JSON.stringify(jsonData)\r\n    };\r\n  } catch (error) {\r\n    console.error(error);\r\n    return {\r\n      statusCode: 500,\r\n      body: JSON.stringify({ error: error.message })\r\n    };\r\n  }\r\n};\r\n\r\nexport const config = {\r\n  path: '/api/exercises/*',\r\n};\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA,IAAM,gBAAgB;AACtB,IAAM,eAAe,QAAQ,IAAI,qBAAqB;AAE/C,IAAM,UAAU,OAAO,UAAU;AAEtC,MAAI,MAAM,eAAe,WAAW;AAClC,WAAO;AAAA,MACL,YAAY;AAAA,MACZ,SAAS;AAAA,QACP,+BAA+B;AAAA,QAC/B,gCAAgC;AAAA,QAChC,gCAAgC;AAAA,MAClC;AAAA,MACA,MAAM;AAAA,IACR;AAAA,EACF;AAEA,MAAI;AAKF,QAAI,OAAO,MAAM;AAOjB,UAAM,iBAAiB;AACvB,UAAM,YAAY;AAElB,QAAI,UAAU;AAEd,QAAI,KAAK,WAAW,cAAc,GAAG;AACnC,gBAAU,KAAK,UAAU,eAAe,MAAM;AAAA,IAChD,WAAW,KAAK,WAAW,SAAS,GAAG;AACrC,gBAAU,KAAK,UAAU,UAAU,MAAM;AAAA,IAC3C;AAMA,UAAM,aAAa,eAAe;AAGlC,UAAM,SAAS,IAAI,gBAAgB,MAAM,qBAAqB;AAC9D,UAAM,cAAc,OAAO,SAAS,IAAI,IAAI,OAAO,SAAS,CAAC,KAAK;AAElE,UAAM,YAAY,WAAW,aAAa,GAAG,UAAU,GAAG,WAAW;AAErE,YAAQ,IAAI,YAAY,IAAI,OAAO,SAAS,EAAE;AAE9C,UAAM,WAAW,MAAM,MAAM,WAAW;AAAA,MACtC,QAAQ,MAAM;AAAA,MACd,SAAS;AAAA,QACP,mBAAmB;AAAA,QACnB,kBAAkB;AAAA,QAClB,gBAAgB;AAAA,MAClB;AAAA,IACF,CAAC;AAED,UAAM,OAAO,MAAM,SAAS,KAAK;AAEjC,QAAI,SAAS;AACb,QAAI,WAAW;AACf,QAAI;AACF,iBAAW,KAAK,MAAM,IAAI;AAC1B,eAAS;AAAA,IACX,SAAS,GAAG;AACV,eAAS;AAAA,IACX;AACA,QAAI,CAAC,QAAQ;AACX,aAAO;AAAA,QACL,YAAY;AAAA,QACZ,SAAS;AAAA,UACP,gBAAgB;AAAA,UAChB,+BAA+B;AAAA,UAC/B,iBAAiB;AAAA,QACnB;AAAA,QACA,MAAM,KAAK,UAAU,EAAE,OAAO,sCAAsC,SAAS,KAAK,MAAM,GAAG,GAAG,EAAE,CAAC;AAAA,MACnG;AAAA,IACF;AACA,WAAO;AAAA,MACL,YAAY,SAAS;AAAA,MACrB,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,+BAA+B;AAAA,QAC/B,iBAAiB,SAAS,KAAK,yBAAyB;AAAA,MAC1D;AAAA,MACA,MAAM,KAAK,UAAU,QAAQ;AAAA,IAC/B;AAAA,EACF,SAAS,OAAO;AACd,YAAQ,MAAM,KAAK;AACnB,WAAO;AAAA,MACL,YAAY;AAAA,MACZ,MAAM,KAAK,UAAU,EAAE,OAAO,MAAM,QAAQ,CAAC;AAAA,IAC/C;AAAA,EACF;AACF;AAEO,IAAM,SAAS;AAAA,EACpB,MAAM;AACR;",
  "names": []
}
