{
  "version": 3,
  "sources": ["file:///S:/VSCodeProjects/Striven/netlify/functions/exercisedb-image.js"],
  "sourceRoot": "C:/Users/rodne/AppData/Local/Temp/tmp-15652-Kj2D3Visf7eO",
  "sourcesContent": ["// netlify/functions/exercisedb-image.js\r\n// Serverless function to proxy RapidAPI ExerciseDB Image requests\r\n\r\nconst RAPIDAPI_HOST = 'exercisedb.p.rapidapi.com';\r\nconst RAPIDAPI_KEY = process.env.VITE_RAPIDAPI_KEY || 'a1ef16478dmshfa2196906761101p1da34ejsn088c64356d48';\r\n\r\nexport const handler = async (event, context) => {\r\n  // Handle CORS preflight\r\n  if (event.httpMethod === 'OPTIONS') {\r\n    return {\r\n      statusCode: 200,\r\n      headers: {\r\n        'Access-Control-Allow-Origin': '*',\r\n        'Access-Control-Allow-Methods': 'GET, OPTIONS',\r\n        'Access-Control-Allow-Headers': 'Content-Type',\r\n      },\r\n      body: ''\r\n    };\r\n  }\r\n\r\n  const { queryStringParameters } = event;\r\n  \r\n  // Get query parameters (exerciseId and resolution)\r\n  const exerciseId = queryStringParameters.exerciseId;\r\n  const resolution = queryStringParameters.resolution || '360';\r\n  \r\n  if (!exerciseId) {\r\n    return {\r\n      statusCode: 400,\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'Access-Control-Allow-Origin': '*',\r\n      },\r\n      body: JSON.stringify({ error: 'exerciseId is required' })\r\n    };\r\n  }\r\n  \r\n  const targetUrl = `https://${RAPIDAPI_HOST}/image?exerciseId=${exerciseId}&resolution=${resolution}`;\r\n  \r\n  console.log(`[ExerciseDB Image Proxy] ${event.httpMethod} ${targetUrl}`);\r\n\r\n  try {\r\n    const response = await fetch(targetUrl, {\r\n      method: 'GET',\r\n      headers: {\r\n        'x-rapidapi-host': RAPIDAPI_HOST,\r\n        'x-rapidapi-key': RAPIDAPI_KEY,\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      console.error(`[ExerciseDB Image Proxy] Error: ${response.status}`);\r\n      return {\r\n        statusCode: response.status,\r\n        headers: {\r\n          'Access-Control-Allow-Origin': '*',\r\n        },\r\n        body: ''\r\n      };\r\n    }\r\n\r\n    // Stream the image response\r\n    const imageBuffer = await response.arrayBuffer();\r\n    \r\n    return {\r\n      statusCode: 200,\r\n      headers: {\r\n        'Content-Type': 'image/gif',\r\n        'Access-Control-Allow-Origin': '*',\r\n        'Cache-Control': 'public, max-age=2592000, immutable', // 30 days\r\n      },\r\n      body: Buffer.from(imageBuffer).toString('base64'),\r\n      isBase64Encoded: true\r\n    };\r\n  } catch (error) {\r\n    console.error('[ExerciseDB Image Proxy] Error:', error);\r\n    return {\r\n      statusCode: 500,\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'Access-Control-Allow-Origin': '*',\r\n      },\r\n      body: JSON.stringify({ error: error.message })\r\n    };\r\n  }\r\n};\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA,IAAM,gBAAgB;AACtB,IAAM,eAAe,QAAQ,IAAI,qBAAqB;AAE/C,IAAM,UAAU,OAAO,OAAO,YAAY;AAE/C,MAAI,MAAM,eAAe,WAAW;AAClC,WAAO;AAAA,MACL,YAAY;AAAA,MACZ,SAAS;AAAA,QACP,+BAA+B;AAAA,QAC/B,gCAAgC;AAAA,QAChC,gCAAgC;AAAA,MAClC;AAAA,MACA,MAAM;AAAA,IACR;AAAA,EACF;AAEA,QAAM,EAAE,sBAAsB,IAAI;AAGlC,QAAM,aAAa,sBAAsB;AACzC,QAAM,aAAa,sBAAsB,cAAc;AAEvD,MAAI,CAAC,YAAY;AACf,WAAO;AAAA,MACL,YAAY;AAAA,MACZ,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,+BAA+B;AAAA,MACjC;AAAA,MACA,MAAM,KAAK,UAAU,EAAE,OAAO,yBAAyB,CAAC;AAAA,IAC1D;AAAA,EACF;AAEA,QAAM,YAAY,WAAW,aAAa,qBAAqB,UAAU,eAAe,UAAU;AAElG,UAAQ,IAAI,4BAA4B,MAAM,UAAU,IAAI,SAAS,EAAE;AAEvE,MAAI;AACF,UAAM,WAAW,MAAM,MAAM,WAAW;AAAA,MACtC,QAAQ;AAAA,MACR,SAAS;AAAA,QACP,mBAAmB;AAAA,QACnB,kBAAkB;AAAA,MACpB;AAAA,IACF,CAAC;AAED,QAAI,CAAC,SAAS,IAAI;AAChB,cAAQ,MAAM,mCAAmC,SAAS,MAAM,EAAE;AAClE,aAAO;AAAA,QACL,YAAY,SAAS;AAAA,QACrB,SAAS;AAAA,UACP,+BAA+B;AAAA,QACjC;AAAA,QACA,MAAM;AAAA,MACR;AAAA,IACF;AAGA,UAAM,cAAc,MAAM,SAAS,YAAY;AAE/C,WAAO;AAAA,MACL,YAAY;AAAA,MACZ,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,+BAA+B;AAAA,QAC/B,iBAAiB;AAAA;AAAA,MACnB;AAAA,MACA,MAAM,OAAO,KAAK,WAAW,EAAE,SAAS,QAAQ;AAAA,MAChD,iBAAiB;AAAA,IACnB;AAAA,EACF,SAAS,OAAO;AACd,YAAQ,MAAM,mCAAmC,KAAK;AACtD,WAAO;AAAA,MACL,YAAY;AAAA,MACZ,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,+BAA+B;AAAA,MACjC;AAAA,MACA,MAAM,KAAK,UAAU,EAAE,OAAO,MAAM,QAAQ,CAAC;AAAA,IAC/C;AAAA,EACF;AACF;",
  "names": []
}
